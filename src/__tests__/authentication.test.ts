/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { expect, test } from "vitest";
import { SDK } from "../index.js";
import { createTestHTTPClient } from "./testclient.js";

test("Authentication Request Token", async () => {
  const testHttpClient = createTestHTTPClient("requestToken");

  const sdk = new SDK({
    httpClient: testHttpClient,
  });

  const result = await sdk.authentication.requestToken({
    grantType: "authorization_code",
    code: "50BTIf2h7Wtg3DAk7ytpG5ML_PsNjfQA4M7iupH_3jw",
    redirectUri: "https://example.com/callback",
    state: "Hawaii",
    clientId: "<id>",
  }, {
    serverURL: process.env["TEST_SERVER_URL"] ?? "http://localhost:18080",
  });
  expect(result.httpMeta.response.status).toBe(200);
  expect(result.tokenData).toBeDefined();
  expect(result.tokenData).toEqual({
    accessToken: "dpo_38347Ae178B4a16C7e42F292c6912E7710c8",
    refreshToken: "dpo_38347Ae178B4a16C7e42F292c6912E7710c9",
    tokenType: "bearer",
    scope: "user:read_write",
    idToken:
      "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.4FjJ3eZJYJj7J9Jf",
    expiresIn: 3600,
  });
});
